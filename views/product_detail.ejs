<%
var dataTweets = __.map(tweetDataArray, function (tweetData) {
    var tweetModel = tweetData.tweetModel;
    return '["' + tweetModel.screenName + '","' + tweetModel.tweetId + '"]';
}).join(',');
var initialDisplayTweetDataArray = __.first(tweetDataArray, 100);

var dataChartLabels = __.map(tweetCountLogModels, function (m) {
    return;
}).join(',');

var dataChartPlots = __.map(tweetCountLogModels, function (m) {
    return '["' + m.createdAt + '",' + m.userCount + ']';
}).join(',');

var productTypeBundleId = Const.PRODUCT_TYPE_ID_TO_BELONGED_PRODUCT_TYPE_BUNDLE_ID[productModel.productTypeId];
var productTypeBundleName = Const.PRODUCT_TYPE_BUNDLE_ID_TO_NAME_HASH[productTypeBundleId];
var productModelName = productModel._modelOptions.name.singular;
var productDetailTemplatePath = 'product_detail/' + productModelName + '.ejs';
var productTypeName = Const.PRODUCT_TYPE_ID_TO_NAME_HASH[productModel.productTypeId];
var productTypeJPName = Const.PRODUCT_TYPE_ID_TO_JA_NAME_HASH[productModel.productTypeId];
var fontAwesomeClassName = Const.PRODUCT_TYPE_BUNDLE_ID_TO_FONT_AWESOME_CLASS[productTypeBundleId];
%>

<!DOCTYPE html>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<link href="/css/common.css" rel="stylesheet">
<link href="/css/product_detail.css" rel="stylesheet">

<html>
<head>
    <%- include(appRoot + '/views/google_analytics.ejs') %>

    <title>
        <%= productModel.title %> のネットの反応【BuzzRanking】
    </title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">

    <meta name=”description” content=”<%= productModel.title %>のネットの反応や人気度推移を紹介！【毎日更新】”>
</head>
<body>

<%- include('header.ejs') %>

<div id="content" class="container-fluid">

    <%- include('product_detail/top_3_ranking_ad.ejs') %>

    <%- include(productDetailTemplatePath, { dataChartPlots: dataChartPlots, }) %>

    <% if (!isInvalidProduct) { %>
        <div class="row">
            <div class="col-12 text-align-center">
                <h2>
                    <span class="no-wrap"><%= productModel.title + (productModel.subTitle ? ' ' + productModel.subTitle : '') %></span><span
                            class="no-wrap">に関連するツイート</span>
                </h2>
            </div>
        </div>

        <div class="row mx-auto tweet-reference-block">
            <div class="col-12">
                <%
                __.each(initialDisplayTweetDataArray, function(tweetData) {
                  var tweetModel = tweetData.tweetModel;
                %>
                    <div class="row">
                        <div class="col-12">
                            <blockquote class="twitter-tweet" data-lang="ja" data-cards="">
                                <a href="https://twitter.com/<%= tweetModel.screenName %>/status/<%= tweetModel.tweetId %>"><%= tweetModel.text %></a>
                            </blockquote>
                        </div>
                    </div>
                <% }); %>
            </div>
        </div>

        <%- include('product_detail/top_3_ranking_ad.ejs', { dataChartPlots: dataChartPlots, }) %>
    <% } else { %>
        <div class="row">
            <div class="col-12 invalid-product-description">
                ※こちらの商品は正確なBuzz度の測定が困難であると判断されたため、ランキング及び関連ツイート表示の対象外となっています。
            </div>
        </div>
    <% } %>

</div>

<%- include('footer.ejs') %>

</body>
</html>

<script src="/js/compressed/product_detail.min.js" type="text/javascript"></script>
